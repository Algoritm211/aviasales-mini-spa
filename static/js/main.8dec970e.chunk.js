(this["webpackJsonpaviasales-tickets"]=this["webpackJsonpaviasales-tickets"]||[]).push([[0],{37:function(e,t,c){},38:function(e,t,c){},45:function(e,t,c){},69:function(e,t,c){},70:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},74:function(e,t,c){},75:function(e,t,c){"use strict";c.r(t);var n=c(1),s=c(10),r=c.n(s),i=(c(37),c(38),c(13)),a=c(2),l=function(e){return e.ticketsReducer.isLoading},d=function(e){return e.ticketsReducer.tickets},o=(c(45),c(20)),u=c.n(o),j=c(30),f=c.n(j);var b=function(e,t){var c=function(e){var t=e/60,c=Math.floor(t),n=60*(t-c),s=Math.round(n).toString();return 1===s.length&&(s="0".concat(s)),{hours:c,minutes:s}}(f()(u()(new Date(e),{minutes:t}),new Date(e)));return"".concat(c.hours,"\u0447 ").concat(c.minutes,"\u043c")},h=function(e,t){var c=new Date(e),n=u()(new Date(c),{minutes:t});return{startHHMM:c.toISOString().substr(11,5),endHHMM:n.toISOString().substr(11,5)}},O=c(0);function m(e){switch(e){case 0:return"\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a";case 1:return"\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430";default:return"\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"}}var x=function(e){var t=e.ticket,c=h(t.segments[0].date,t.segments[0].duration),n=h(t.segments[1].date,t.segments[1].duration);return Object(O.jsxs)("div",{className:"ticket",children:[Object(O.jsxs)("div",{className:"ticket__header",children:[Object(O.jsx)("div",{className:"ticket__header-price",children:Math.round(t.price).toLocaleString("ru-RU",{style:"currency",currency:"RUB"})}),Object(O.jsx)("div",{className:"ticket__header-logo",children:Object(O.jsx)("img",{src:"https://pics.avs.io/99/36/".concat(t.carrier,".png"),alt:"carrier"})})]}),Object(O.jsxs)("div",{className:"ticket__content",children:[Object(O.jsxs)("div",{className:"ticket__info",children:[Object(O.jsxs)("div",{className:"ticket__info-cell",children:[Object(O.jsxs)("div",{className:"ticket__info-cell-header",children:[t.segments[0].origin," - ",t.segments[0].destination]}),Object(O.jsxs)("div",{className:"ticket__info-cell-content",children:[c.startHHMM," - ",c.endHHMM]})]}),Object(O.jsxs)("div",{className:"ticket__info-cell",children:[Object(O.jsx)("div",{className:"ticket__info-cell-header",children:"\u0412 \u043f\u0443\u0442\u0438"}),Object(O.jsx)("div",{className:"ticket__info-cell-content",children:b(t.segments[0].date,t.segments[0].duration)})]}),Object(O.jsxs)("div",{className:"ticket__info-cell",children:[Object(O.jsxs)("div",{className:"ticket__info-cell-header",children:[t.segments[0].stops.length," ",m(t.segments[0].stops.length)]}),Object(O.jsx)("div",{className:"ticket__info-cell-content",children:t.segments[0].stops.join(", ")})]})]}),Object(O.jsxs)("div",{className:"ticket__info",children:[Object(O.jsxs)("div",{className:"ticket__info-cell",children:[Object(O.jsxs)("div",{className:"ticket__info-cell-header",children:[t.segments[1].origin," - ",t.segments[1].destination]}),Object(O.jsxs)("div",{className:"ticket__info-cell-content",children:[n.startHHMM," - ",n.endHHMM]})]}),Object(O.jsxs)("div",{className:"ticket__info-cell",children:[Object(O.jsx)("div",{className:"ticket__info-cell-header",children:"\u0412 \u043f\u0443\u0442\u0438"}),Object(O.jsx)("div",{className:"ticket__info-cell-content",children:b(t.segments[1].date,t.segments[1].duration)})]}),Object(O.jsxs)("div",{className:"ticket__info-cell",children:[Object(O.jsxs)("div",{className:"ticket__info-cell-header",children:[t.segments[1].stops.length," ",m(t.segments[1].stops.length)]}),Object(O.jsx)("div",{className:"ticket__info-cell-content",children:t.segments[1].stops.join(", ")})]})]})]})]})},v=c(7),p=c.n(v),_=c(12),g=c(5),k=c(31),N=c.n(k).a.create({baseURL:"https://front-test.beta.aviasales.ru/"}),y=function(){return N.get("search").then((function(e){return e.data}))},R=function(e){return N.get("tickets?searchId=".concat(e)).then((function(e){return e.data}))},C=Object(g.b)("appReducer/getSearchId",Object(_.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),w=Object(g.c)({name:"appReducer",initialState:{searchId:null,isReady:!1,isError:!1},reducers:{setError:function(e,t){e.isError=t.payload}},extraReducers:function(e){e.addCase(C.fulfilled,(function(e,t){e.searchId=t.payload.searchId,e.isReady=!0}))}}),M=w.actions.setError,S=w.reducer,H=Object(g.b)("ticketsReducer/loadAllTickets",function(){var e=Object(_.a)(p.a.mark((function e(t,c){var n,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.dispatch(L(!0)),n=c.getState().appReducer.searchId,s={tickets:[],stop:!1},e.prev=3,e.next=6,R(n);case 6:s=e.sent,c.dispatch(L(!1)),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0),c.dispatch(M(!0));case 14:return e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,c){return e.apply(this,arguments)}}()),I=Object(g.c)({name:"ticketsReducer",initialState:{tickets:[],stop:!1,isLoading:!1},reducers:{setLoading:function(e,t){e.isLoading=t.payload}},extraReducers:function(e){e.addCase(H.fulfilled,(function(e,t){e.tickets=t.payload.tickets,e.stop=t.payload.stop}))}}),L=I.actions.setLoading,T=I.reducer,E=(c(69),c(14)),F=c.n(E),D=function(e){return e.filterReducer.numberOfTransfers},B=(c(70),function(){return Object(O.jsx)("div",{className:"loader",children:Object(O.jsx)("div",{className:"loadingio-spinner-magnify-kfuigzlosva",children:Object(O.jsx)("div",{className:"ldio-ohbisq7qyn",children:Object(O.jsx)("div",{children:Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{}),Object(O.jsx)("div",{})]})})})})})});var U=function(){var e=Object(a.b)(),t=Object(a.c)(d),c=Object(a.c)(l),s=Object(n.useState)("optimal"),r=Object(i.a)(s,2),o=r[0],u=r[1],j=Object(a.c)(D);Object(n.useEffect)((function(){e(H("load"))}),[e]);var f=(t=function(e,t){if(0===t.length||t.includes(-1))return e;if(t.includes(0))return e.slice().filter((function(e){return 0===e.segments[0].stops.length&&0===e.segments[1].stops.length}));for(var c=[],n=0;n<e.length;n++)t.includes(e[n].segments[0].stops.length)&&t.includes(e[n].segments[1].stops.length)&&c.push(e[n]);return c}(t=function(e,t){return"cheapest"===t?e=e.slice().sort((function(e,t){return e.price-t.price})):"fastest"===t?e=e.slice().sort((function(e,t){return e.segments[0].duration-t.segments[0].duration})):e}(t,o),j)).map((function(e,t){return Object(O.jsx)(x,{ticket:e},t)}));return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"filter",children:[Object(O.jsx)("div",{onClick:function(){return u("cheapest")},className:F()("filter__cell",{active:"cheapest"===o}),children:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"}),Object(O.jsx)("div",{onClick:function(){return u("fastest")},className:F()("filter__cell",{active:"fastest"===o}),children:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"}),Object(O.jsx)("div",{onClick:function(){return u("optimal")},"data-sort":"optimal",className:F()("filter__cell",{active:"optimal"===o}),children:"\u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439"})]}),Object(O.jsx)("div",{children:c?Object(O.jsx)(B,{}):f})]})},q=c(32),A=(c(71),Object(g.c)({name:"filterReducer",initialState:{numberOfTransfers:[]},reducers:{setNumberTransfers:function(e,t){e.numberOfTransfers=t.payload.numberOfTransfers}}})),J=A.actions.setNumberTransfers,P=A.reducer,z=function(){var e=Object(a.b)(),t=Object(n.useState)([]),c=Object(i.a)(t,2),s=c[0],r=c[1],l=function(e){s.includes(e)?r((function(t){return t.filter((function(t){return t!==e}))})):r((function(t){return[].concat(Object(q.a)(t),[e])}))};return Object(n.useEffect)((function(){e(J({numberOfTransfers:s}))}),[e,s]),Object(O.jsxs)("div",{className:"fContainer",children:[Object(O.jsx)("div",{className:"fContainer__header",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),Object(O.jsxs)("div",{className:"fContainer__filters",children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",id:"all",onClick:function(){return l(-1)}}),Object(O.jsx)("label",{htmlFor:"all",children:"\u0412\u0441\u0435"})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",id:"without_transfer",onClick:function(){return l(0)}}),Object(O.jsx)("label",{htmlFor:"without_transfer",children:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",id:"1_transfer",onClick:function(){return l(1)}}),Object(O.jsx)("label",{htmlFor:"1_transfer",children:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430"})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",id:"2_transfer",onClick:function(){return l(2)}}),Object(O.jsx)("label",{htmlFor:"2_transfer",children:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",id:"3_transfer",onClick:function(){return l(3)}}),Object(O.jsx)("label",{htmlFor:"3_transfer",children:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"})]})]})]})},G=(c(72),c.p+"static/media/plane-header.df195519.svg"),K=(c(73),function(){return Object(O.jsx)("div",{className:"header",children:Object(O.jsx)("img",{src:G,alt:"header-plane"})})}),Q=function(){return Object(O.jsxs)("div",{className:"mainLayout",children:[Object(O.jsx)("header",{children:Object(O.jsx)(K,{})}),Object(O.jsxs)("main",{className:"main",children:[Object(O.jsx)("div",{children:Object(O.jsx)(z,{})}),Object(O.jsx)("div",{children:Object(O.jsx)(U,{})})]})]})},V=function(e){return e.appReducer.isReady},W=function(e){return e.appReducer.isError},X=(c(74),function(){return Object(O.jsxs)("div",{className:"error",children:[Object(O.jsx)("div",{className:"error__header",children:"\u0423\u043f\u0441, \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"}),Object(O.jsxs)("div",{className:"error__reload",children:[Object(O.jsx)("div",{children:"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437, \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"}),Object(O.jsx)("div",{className:"error__reload-btn",onClick:function(){location.reload()},children:"\u041f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})]})});var Y=function(){var e=Object(a.b)(),t=Object(a.c)(V),c=Object(a.c)(W);return Object(n.useEffect)((function(){e(C())}),[e]),c?Object(O.jsx)(X,{}):Object(O.jsx)("div",{className:"App",children:t?Object(O.jsx)(Q,{}):Object(O.jsx)(B,{})})},Z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,76)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,i=t.getTTFB;c(e),n(e),s(e),r(e),i(e)}))},$=c(4),ee=Object($.c)({appReducer:S,ticketsReducer:T,filterReducer:P}),te=Object(g.a)({reducer:ee});window.__store__=te;var ce=te;r.a.render(Object(O.jsx)(a.a,{store:ce,children:Object(O.jsx)(Y,{})}),document.getElementById("root")),Z()}},[[75,1,2]]]);
//# sourceMappingURL=main.8dec970e.chunk.js.map